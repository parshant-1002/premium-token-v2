import React, { useEffect, useState } from 'react';
import "./flipnumber.scss"
import { formatNumber } from '../../shared/constants/utils';

const SmoothFlipCounter = ({ initialValue, socket }) => {
    console.log(initialValue,"intialvalue")
    const [value, setValue] = useState(initialValue);
    // const [counterSettings,     ] = useState({
    //     digits: settings.digits || 5,
    //     delay: settings.delay || 250,
    //     direction: settings.direction || '',
    // });

    // useEffect(() => {
    //     const interval = setInterval(() => {
    //         // Update the value dynamically, e.g., from the backend
    //         setValue((prevValue) => prevValue + 5365); // Example update
    //     }, 3000);

    //     return () => clearInterval(interval);
    // }, []);

    useEffect(() => {
        if (socket) {
            socket.on('blockChainData', (data) => {
                setValue(data?.marketCap)
            });
        }
    }, [socket]);

    const renderDigits = () => {
        const digits = formatNumber(value).toString().split('');
        return digits.map((digit, index) => (
             digit != "," &&
            <div className={`digit_card ${digits[index+1] == "," ? "add_separator" : ""}`}  key={index}>
                {console.log(digit == "","digit><><><><<")}
              <span data-value={digit}>{digit}</span>
            </div>
        ));
    };

    return (
        <div className="d-flex justify-content-center text-center market_counter">
            <div className="numCounter" data-value={value}>
                {renderDigits()}
            </div>
            <span className="currency_sign">
                <svg width="35" height="60" viewBox="0 0 35 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.1735 45.32C23.6935 44.744 25.4535 42.8133 25.4535 39.528C25.4535 38.2907 25.0588 37.32 24.2695 36.616C23.5015 35.8907 22.4775 35.2827 21.1975 34.792L20.1735 45.32ZM17.1975 14.152C16.2162 14.3013 15.3842 14.5253 14.7015 14.824C14.0402 15.1227 13.4962 15.4747 13.0695 15.88C12.6642 16.2853 12.3655 16.744 12.1735 17.256C11.9815 17.7467 11.8855 18.2693 11.8855 18.824C11.8855 20.0827 12.2908 21.1067 13.1015 21.896C13.9122 22.664 14.9575 23.3147 16.2375 23.848L17.1975 14.152ZM22.0935 25.768C23.1175 26.0667 24.1415 26.3973 25.1655 26.76C26.1895 27.1013 27.1708 27.5067 28.1095 27.976C29.0695 28.424 29.9548 28.9467 30.7655 29.544C31.5975 30.1413 32.3122 30.8453 32.9095 31.656C33.5282 32.4667 34.0082 33.3947 34.3495 34.44C34.6908 35.4853 34.8615 36.6907 34.8615 38.056C34.8615 40.0827 34.5202 41.992 33.8375 43.784C33.1548 45.5547 32.1522 47.1333 30.8295 48.52C29.5068 49.8853 27.8855 51.0053 25.9655 51.88C24.0455 52.7333 21.8482 53.256 19.3735 53.448L18.9895 57.416C18.9468 58.0133 18.6802 58.5467 18.1895 59.016C17.7202 59.5067 17.1122 59.752 16.3655 59.752H12.7175L13.3575 53.16C10.9042 52.7547 8.5575 52.0507 6.3175 51.048C4.09883 50.024 2.2215 48.7973 0.6855 47.368L3.7575 42.92C4.0135 42.5573 4.35483 42.2587 4.7815 42.024C5.2295 41.768 5.69883 41.64 6.1895 41.64C6.7015 41.64 7.22417 41.7787 7.7575 42.056C8.29083 42.312 8.86683 42.632 9.4855 43.016C10.1255 43.3787 10.8188 43.7627 11.5655 44.168C12.3335 44.552 13.1975 44.872 14.1575 45.128L15.3415 33.064C13.8055 32.6373 12.2695 32.136 10.7335 31.56C9.21883 30.984 7.8535 30.2053 6.6375 29.224C5.4215 28.2427 4.4295 26.9947 3.6615 25.48C2.91483 23.9653 2.5415 22.0667 2.5415 19.784C2.5415 18.0987 2.88283 16.456 3.5655 14.856C4.24817 13.256 5.24017 11.816 6.5415 10.536C7.86417 9.256 9.4855 8.21066 11.4055 7.4C13.3255 6.568 15.5228 6.088 17.9975 5.96L18.3495 2.408C18.3922 1.81066 18.6482 1.27733 19.1175 0.807999C19.6082 0.317332 20.2268 0.0719986 20.9735 0.0719986H24.6215L24.0135 6.344C26.3175 6.77066 28.2908 7.464 29.9335 8.424C31.5975 9.384 33.0055 10.408 34.1575 11.496L31.7255 15.048C31.3628 15.5813 30.9895 15.976 30.6055 16.232C30.2428 16.4667 29.8055 16.584 29.2935 16.584C28.9735 16.584 28.5895 16.5093 28.1415 16.36C27.7148 16.1893 27.2455 15.9973 26.7335 15.784C26.2215 15.5493 25.6668 15.3147 25.0695 15.08C24.4935 14.824 23.8748 14.6 23.2135 14.408L22.0935 25.768Z" fill="#89B9B1" fill-opacity="0.9" />
                    <path d="M20.1735 45.32C23.6935 44.744 25.4535 42.8133 25.4535 39.528C25.4535 38.2907 25.0588 37.32 24.2695 36.616C23.5015 35.8907 22.4775 35.2827 21.1975 34.792L20.1735 45.32ZM17.1975 14.152C16.2162 14.3013 15.3842 14.5253 14.7015 14.824C14.0402 15.1227 13.4962 15.4747 13.0695 15.88C12.6642 16.2853 12.3655 16.744 12.1735 17.256C11.9815 17.7467 11.8855 18.2693 11.8855 18.824C11.8855 20.0827 12.2908 21.1067 13.1015 21.896C13.9122 22.664 14.9575 23.3147 16.2375 23.848L17.1975 14.152ZM22.0935 25.768C23.1175 26.0667 24.1415 26.3973 25.1655 26.76C26.1895 27.1013 27.1708 27.5067 28.1095 27.976C29.0695 28.424 29.9548 28.9467 30.7655 29.544C31.5975 30.1413 32.3122 30.8453 32.9095 31.656C33.5282 32.4667 34.0082 33.3947 34.3495 34.44C34.6908 35.4853 34.8615 36.6907 34.8615 38.056C34.8615 40.0827 34.5202 41.992 33.8375 43.784C33.1548 45.5547 32.1522 47.1333 30.8295 48.52C29.5068 49.8853 27.8855 51.0053 25.9655 51.88C24.0455 52.7333 21.8482 53.256 19.3735 53.448L18.9895 57.416C18.9468 58.0133 18.6802 58.5467 18.1895 59.016C17.7202 59.5067 17.1122 59.752 16.3655 59.752H12.7175L13.3575 53.16C10.9042 52.7547 8.5575 52.0507 6.3175 51.048C4.09883 50.024 2.2215 48.7973 0.6855 47.368L3.7575 42.92C4.0135 42.5573 4.35483 42.2587 4.7815 42.024C5.2295 41.768 5.69883 41.64 6.1895 41.64C6.7015 41.64 7.22417 41.7787 7.7575 42.056C8.29083 42.312 8.86683 42.632 9.4855 43.016C10.1255 43.3787 10.8188 43.7627 11.5655 44.168C12.3335 44.552 13.1975 44.872 14.1575 45.128L15.3415 33.064C13.8055 32.6373 12.2695 32.136 10.7335 31.56C9.21883 30.984 7.8535 30.2053 6.6375 29.224C5.4215 28.2427 4.4295 26.9947 3.6615 25.48C2.91483 23.9653 2.5415 22.0667 2.5415 19.784C2.5415 18.0987 2.88283 16.456 3.5655 14.856C4.24817 13.256 5.24017 11.816 6.5415 10.536C7.86417 9.256 9.4855 8.21066 11.4055 7.4C13.3255 6.568 15.5228 6.088 17.9975 5.96L18.3495 2.408C18.3922 1.81066 18.6482 1.27733 19.1175 0.807999C19.6082 0.317332 20.2268 0.0719986 20.9735 0.0719986H24.6215L24.0135 6.344C26.3175 6.77066 28.2908 7.464 29.9335 8.424C31.5975 9.384 33.0055 10.408 34.1575 11.496L31.7255 15.048C31.3628 15.5813 30.9895 15.976 30.6055 16.232C30.2428 16.4667 29.8055 16.584 29.2935 16.584C28.9735 16.584 28.5895 16.5093 28.1415 16.36C27.7148 16.1893 27.2455 15.9973 26.7335 15.784C26.2215 15.5493 25.6668 15.3147 25.0695 15.08C24.4935 14.824 23.8748 14.6 23.2135 14.408L22.0935 25.768Z" fill="url(#paint0_linear_13_48339)" fill-opacity="0.4" />
                    <defs>
                        <linearGradient id="paint0_linear_13_48339" x1="18.7844" y1="43.1034" x2="18.7844" y2="3.93966" gradientUnits="userSpaceOnUse">
                            <stop stop-color="white" stop-opacity="0" />
                            <stop offset="1" stop-color="white" />
                        </linearGradient>
                    </defs>
                </svg>
            </span>
        </div>
    );
};

export default SmoothFlipCounter;
